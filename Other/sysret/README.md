Windows Kernel Intel x64 SYSRET Vulnerability Exploit + Kernel Code Signing Bypass Bonus

The shellcode disables kernel Code Signing and will grant NT SYSTEM privilege to specified Application or already running process (PID).
exploit successfully tested on Windows 7 SP0/1 (x64) and Windows 2008 R2 SP1 (x64).

-Shahriyar Jalayeri ( @ponez )